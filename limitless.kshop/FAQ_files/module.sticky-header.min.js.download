!function(e){"use strict";theme.StickyHeader=function(){function t(){this.load()}t.prototype=e.extend({},t.prototype,{load:function(){var t=e(".js-header-sticky"),i=t.attr("data-js-sticky"),s=t.attr("data-js-desktop-sticky-sidebar");if(t.length){var o={bp:1024};"desktop_and_mobile"!==i&&"desktop"!==i||(e.extend(o,{desktop:{sticky:"[data-js-desktop-sticky]",limit:"bottom",fade:!0,duration:function(){return 1e3*theme.animations.sticky_header.duration}}}),"true"===s&&e.extend(o.desktop,{move:[{elem:'[data-js-sticky-replace-element="logo"]',to:'[data-js-sticky-replace-here="logo"]'},{elem:'[data-js-sticky-replace-element="cart"]',to:'[data-js-sticky-replace-here="cart"]'},{elem:'[data-js-sticky-replace-element="wishlist"]',to:'[data-js-sticky-replace-here="wishlist"]'},{elem:'[data-js-sticky-replace-element="compare"]',to:'[data-js-sticky-replace-here="compare"]'}]})),"desktop_and_mobile"!==i&&"mobile"!==i||e.extend(o,{mobile:{sticky:"[data-js-mobile-sticky]",limit:"bottom",fade:!1}}),this.api=this.init(t,o)}},init:function(t,i){if(t.length){var s={_create:function(){var t=this,i=this.bindings,s=i.find(this.options.mobile&&this.options.mobile.sticky?this.options.mobile.sticky:""),o=i.find(this.options.desktop&&this.options.desktop.sticky?this.options.desktop.sticky:""),a=e("<div>").addClass("header__spacer header__spacer--m").insertBefore(s),c=e("<div>").addClass("header__spacer header__spacer--d").insertBefore(o);function n(){var e=theme.current.is_desktop;t.bp=e?"desktop":"mobile",t.$sticky=e?o:s,t.$spacer=e?c:a,t.$sticky.length&&(e?(a.removeClass("header__spacer--visible"),c.addClass("header__spacer--visible"),s.hasClass(t.sticky_class)&&(t._unfix(s,a),t._return(t.options.mobile))):(c.removeClass("header__spacer--visible"),a.addClass("header__spacer--visible"),o.hasClass(t.sticky_class)&&(t._unfix(o,c),t._return(t.options.desktop))))}function r(){if(t.$sticky.length){var e=t.options[t.bp].limit?t.options[t.bp].limit:0,i=t.$spacer[0].getBoundingClientRect();"bottom"===e&&(e=t.$sticky.hasClass(t.sticky_class)?t.$spacer.innerHeight():t.$sticky.innerHeight()),e*=-1,i.top<e?(t.$sticky.hasClass(t.sticky_class)||(t._fix(t.$sticky,t.$spacer),t._move(t.options[t.bp]),$window.trigger("verticalmenu.checkheight")),ie||t._check_height(t.$sticky,t.options[t.bp])):t.$sticky.hasClass(t.sticky_class)&&(t._unfix(t.$sticky,t.$spacer),t._return(t.options[t.bp]),$window.trigger("verticalmenu.checkheight"))}}this.sticky_class="header__content--sticky",n(),r(),theme.current.is_desktop&&theme.VerticalMenu&&theme.VerticalMenu.checkHeightVerticalMenu&&setTimeout((function(){$window.trigger("verticalmenu.checkheight")}),50),$window.on({"theme.resize.stickyHeader":function(){n(),r()},"scroll.stickyHeader":r})},_fix:function(e,t){var i=e.innerHeight();t.height(i),this.options[this.bp].fade&&e.css({opacity:0}).velocity({opacity:theme.animations.sticky_header.opacity},this.options[this.bp].duration()),e.addClass(this.sticky_class)},_unfix:function(e,t){t.removeAttr("style"),this.options[this.bp].fade&&e.velocity("stop",!0),e.removeAttr("style").removeClass(this.sticky_class)},_move:function(t){t.move&&e.each(t.move,(function(){var t=e(this.elem),i=e(this.to),s=this.method||"append";this.$elem=t,this.$parent=t.parent(),i[s](t)}))},_return:function(t){t.move&&e.each(t.move,(function(){var e=this.method||"append";this.$parent[e](this.$elem),this.$elem=null,this.$parent=null}))},_check_height:function(e,t){if(t.height){var i=this.$spacer[0].getBoundingClientRect(),s=i.bottom<=t.height?t.height:i.bottom;e.css({"min-height":s})}},getStickyHeight:function(){return this.options[this.bp]?this.options[this.bp].height||e(this.options[this.bp].sticky).innerHeight():0},destroy:function(){e(window).unbind("resize.stickyHeader scroll.stickyHeader"),e.Widget.prototype.destroy.call(this)}};return e.widget("ui.stickyHeader",s),t.stickyHeader(i),this.$sticky=t,{destroy:function(){t.stickyHeader("destroy")}}}}}),theme.StickyHeader=new t},e((function(){theme.StickyHeader(),theme.current.is_desktop&&theme.StickySidebar&&theme.StickyHeader.$sticky.find(".header__content--sticky").length&&theme.StickySidebar.update()}))}(jQueryTheme);